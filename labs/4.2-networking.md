# Networking Fundamentals

Networking is a critical skill for system administrators and engineers working with Linux systems. Understanding how to configure network interfaces, diagnose connectivity issues, and monitor network traffic enables you to maintain reliable, secure infrastructure and troubleshoot problems quickly.

Modern cloud environments and distributed systems rely heavily on proper network configuration. Whether you're setting up a web server, debugging connection issues, or analyzing security concerns, these networking fundamentals are essential tools in your daily work.

Mastering Linux networking commands allows you to diagnose problems efficiently, verify connectivity, analyze traffic patterns, and understand how your systems communicate across networks—skills that are invaluable in both development and production environments.

### Estimated Time: 40 Minutes

## Part 1: Network Interface Information

1. Create a working directory for this lab
```
mkdir -p ~/network_lab && cd ~/network_lab
```

2. Display all network interfaces and their IP addresses
```
ip addr show
# or the shorter version
ip a
```

3. Display information about a specific interface
```
# Replace eth0 with your actual interface name (might be ens5, enp0s3, etc.)
ip addr show eth0

# Show only IPv4 addresses
ip -4 addr show
```

4. View routing table
```
ip route show
# or
ip r
```

5. Display default gateway
```
ip route | grep default
```

6. Show network interface statistics
```
ip -s link
```

**Understanding the output:**
- `lo` - Loopback interface (127.0.0.1) for local communication
- `eth0/ens5/enp0s3` - Primary network interface (name varies by system)
- `inet` - IPv4 address
- `inet6` - IPv6 address
- `UP` - Interface is active

## Part 2: Testing Network Connectivity

1. Test basic connectivity to a host
```
ping -c 4 google.com
```

**Flags explained:**
- `-c 4` - Send only 4 packets (instead of continuous)

2. Ping specific IP addresses
```
ping -c 3 8.8.8.8          # Google DNS
ping -c 3 1.1.1.1          # Cloudflare DNS
```

3. Test connectivity with different packet sizes
```
ping -c 3 -s 1000 google.com
```

4. Check if a specific host is reachable with timeout
```
ping -c 1 -W 2 192.168.1.1  # Wait max 2 seconds
echo $?  # 0 = success, non-zero = failure
```

## Part 3: DNS Resolution and Host Information

1. Look up IP address of a domain
```
nslookup google.com
```

2. Use `dig` for detailed DNS information
```
# Install dig if not available
sudo dnf install -y bind-utils

# Query DNS
dig google.com

# Get just the IP address
dig +short google.com

# Query specific DNS server
dig @8.8.8.8 amazon.com

# Query specific record types
dig google.com MX    # Mail servers
dig google.com NS    # Name servers
dig google.com TXT   # Text records
```

3. Use `host` command for quick lookups
```
host google.com
host 8.8.8.8        # Reverse DNS lookup
```

4. Check your system's DNS configuration
```
cat /etc/resolv.conf
```

## Part 4: Port and Service Scanning

1. Check listening ports on your system
```
# Show all listening TCP ports
sudo ss -tlnp

# Show all listening UDP ports
sudo ss -ulnp

# Show all connections (listening and established)
sudo ss -tulanp
```

**Flags explained:**
- `-t` - TCP sockets
- `-u` - UDP sockets
- `-l` - Listening sockets
- `-n` - Show numeric addresses (don't resolve names)
- `-p` - Show process information

2. Alternative using netstat (older tool, may need installation)
```
sudo netstat -tlnp
```

3. Check if a specific port is open on a remote host.

**WARNING** - Checking Ports can be considered a cyber security crime. Only check ports on your own servers

```
# Install nc (netcat) if not available
sudo dnf install -y nmap-ncat

# Check if port 80 is open on google.com
nc -zv localhost 80

# Check multiple ports
nc -zv localhost 80 443

# Check with timeout
timeout 2 nc -zv localhost 22
```

4. Test HTTP connectivity
```
curl -I https://www.google.com
curl -o /dev/null -s -w "HTTP Status: %{http_code}\n" https://www.google.com
```

## Part 5: Trace Network Routes

1. Trace the route packets take to reach a destination
```
# Install traceroute if not available
sudo dnf install -y traceroute

# Trace route to google.com
traceroute google.com

# Trace route with numeric output (faster)
traceroute -n 8.8.8.8
```


## Part 6: Network Traffic Analysis

1. Capture network traffic with tcpdump (requires root)
```
# Install tcpdump if not available
sudo dnf install -y tcpdump

# Capture 10 packets on any interface
sudo tcpdump -c 10

# Capture only ICMP traffic (ping)
sudo tcpdump -i any icmp -c 5

# In another terminal, generate some traffic:
# ping -c 3 google.com
```

2. Save captured packets to a file for analysis
```
sudo tcpdump -i any -c 20 -w capture.pcap

# Read the captured file
sudo tcpdump -r capture.pcap
```

## Part 7: Testing Network Speed and Bandwidth

1. Test download speed with curl
```
# Download a test file and measure speed
curl -o /dev/null http://speedtest.tele2.net/10MB.zip

# Show progress and speed
curl -# -o /dev/null http://speedtest.tele2.net/1MB.zip
```

2. Measure response time for HTTP requests
```
curl -o /dev/null -s -w "Time: %{time_total}s\n" https://www.google.com
```

3. Create a simple network speed test script
```
cat << 'EOF' > speedtest.sh
#!/bin/bash
echo "=== Network Speed Test ==="

echo -n "Testing DNS resolution: "
time dig +short google.com > /dev/null 2>&1

echo -n "Testing ping latency to 8.8.8.8: "
ping -c 4 8.8.8.8 | grep avg | awk -F'/' '{print "Average: " $5 "ms"}'

echo "Testing download speed (1MB file):"
curl -o /dev/null -w "Downloaded at %{speed_download} bytes/sec\n" http://speedtest.tele2.net/1MB.zip 2>/dev/null
EOF

chmod +x speedtest.sh
./speedtest.sh
```

## Part 8: Network Configuration Files


1. View interface configuration files (location varies by distribution)
```
# On Amazon Linux 2023/RHEL-based systems
ls /etc/sysconfig/network-scripts/

# View hostname
hostname
cat /etc/hostname
cat /etc/hosts
```


## Part 9: Firewall Basics

1. Check firewall status (firewalld on RHEL-based systems)
```
# Check if firewalld is running
sudo systemctl status firewalld

# If not installed, install it
sudo dnf install -y firewalld

# Start firewalld
sudo systemctl start firewalld
```

2. View firewall rules
```
sudo firewall-cmd --list-all

# List all allowed services
sudo firewall-cmd --list-services
```

3. Add a firewall rule (example only - be careful in production)
```
# Allow HTTP traffic
sudo firewall-cmd --add-service=http --permanent

# Reload firewall to apply changes
sudo firewall-cmd --reload

# Verify changes
sudo firewall-cmd --list-all
```

4. Clean up - disable and stop firewalld
```
# Stop firewalld
sudo systemctl stop firewalld

# Disable firewalld from starting on boot
sudo systemctl disable firewalld

# Verify it's stopped
sudo systemctl status firewalld
```

## Part 10: Practical Network Diagnostics

1. Create a comprehensive network diagnostic script
```
cat << 'EOF' > network_check.sh
#!/bin/bash
echo "=== Network Diagnostic Report ===" > network_report.txt
echo "Generated: $(date)" >> network_report.txt
echo "" >> network_report.txt

# Interface information
echo "=== Network Interfaces ===" >> network_report.txt
ip addr show >> network_report.txt
echo "" >> network_report.txt

# Routing table
echo "=== Routing Table ===" >> network_report.txt
ip route show >> network_report.txt
echo "" >> network_report.txt

# DNS configuration
echo "=== DNS Configuration ===" >> network_report.txt
cat /etc/resolv.conf >> network_report.txt
echo "" >> network_report.txt

# Test connectivity
echo "=== Connectivity Tests ===" >> network_report.txt
ping -c 3 8.8.8.8 >> network_report.txt 2>&1 && echo "Internet: OK" || echo "Internet: FAILED"
ping -c 3 google.com >> network_report.txt 2>&1 && echo "DNS: OK" || echo "DNS: FAILED"

# Listening ports
echo "=== Listening Ports ===" >> network_report.txt
sudo ss -tlnp >> network_report.txt 2>&1

echo "Report saved to network_report.txt"
cat network_report.txt
EOF

chmod +x network_check.sh
./network_check.sh
```

2. Test multiple hosts for availability
```
cat << 'EOF' > check_hosts.sh
#!/bin/bash
HOSTS=("google.com" "github.com" "amazon.com" "8.8.8.8")

echo "=== Host Availability Check ==="
for host in "${HOSTS[@]}"; do
    if ping -c 1 -W 2 "$host" > /dev/null 2>&1; then
        echo "✓ $host is reachable"
    else
        echo "✗ $host is unreachable"
    fi
done
EOF

chmod +x check_hosts.sh
./check_hosts.sh
```

## Cleanup
```
cd ~
rm -rf ~/network_lab
```

## Conclusion

In this lab, you mastered essential Linux networking skills that are crucial for system administration and troubleshooting:

- **Interface management**: Viewing network interfaces, IP addresses, and routing tables with `ip` commands
- **Connectivity testing**: Using `ping` to verify network reachability and measure latency
- **DNS operations**: Resolving domain names with `dig`, `nslookup`, and `host` commands
- **Port scanning**: Checking listening ports and established connections with `ss` and `netstat`
- **Route tracing**: Diagnosing network paths with `traceroute` and `mtr`
- **Traffic analysis**: Capturing and analyzing packets with `tcpdump`
- **Network diagnostics**: Creating scripts to automate network health checks
- **Firewall basics**: Managing firewall rules with `firewall-cmd`

These networking fundamentals enable you to diagnose connectivity issues, verify service availability, analyze network performance, and troubleshoot problems in production environments. Understanding how to use these tools efficiently is essential for maintaining reliable infrastructure.

Whether you're debugging a failed connection, verifying DNS resolution, checking if a service is listening on the correct port, or analyzing network traffic for security issues, these skills form the foundation of network troubleshooting and system administration.

As you progress in your career, you'll build upon these fundamentals to work with more advanced networking concepts like VPNs, load balancers, container networking, and cloud network architecture.
