# System Monitoring and Process Management

System monitoring is a critical skill for system administrators who must maintain server performance, troubleshoot issues, and ensure system stability. When servers experience high load, memory pressure, or process failures, administrators need tools to quickly identify problems and take corrective action.

Linux provides powerful monitoring tools that reveal real-time system metrics, process behavior, and resource usage. Learning to interpret these metrics and manage processes effectively enables you to maintain reliable systems and respond quickly to performance issues.

Understanding how to simulate system stress, monitor resource consumption, and control processes prepares you for real-world scenarios where servers face varying workloads and unexpected demands.

### Estimated Time: 35 Minutes

## Part 1: Process Management and Monitoring

1. Create a monitoring workspace and install the stress testing tool
```
mkdir -p ~/monitoring && cd ~/monitoring
sudo dnf install -y stress htop
```

2. Start a controlled stress test to simulate high CPU usage
```
stress --cpu 2 --timeout 300s &
echo "Stress test PID: $!"
```

3. Monitor system performance in real-time using multiple tools
```
# View processes sorted by CPU usage
top
# Press 'P' to sort by CPU, 'M' for memory, 'q' to quit, 'h' for help

# Alternative: use htop for better visualization (if installed)
htop
# Press F10 or 'q' to quit
```

4. Examine processes using different ps command variations
```
ps aux | grep stress              # Find stress processes
ps -eo pid,ppid,cmd,%cpu,%mem --sort=-%cpu | head -10  # Top CPU consumers
ps -efH | grep stress -B 3           # Show process hierarchy
```

5. Practice process control with signals
```
# Find stress process IDs
pgrep stress

# kill the stress test
pkill -9 stress
ps aux | grep stress             # Verify processes stopped
```

## Part 2: System Resource Monitoring

1. Start a new stress test targeting memory and CPU
```
stress --cpu 2 --vm 1 --vm-bytes 512M --timeout 180s &
```

2. Monitor system resources comprehensively
```
# Memory usage overview
free -h

# Disk usage and mounted filesystems  
df -h
df -i                            # Check inode usage

# Estimate file space usage per file
du ~

# System load and uptime
uptime
cat /proc/loadavg
```

3. Examine detailed system information
```
# System and kernel details
uname -a
cat /proc/version

# CPU information
lscpu
cat /proc/cpuinfo | grep "model name" | head -1

# Memory modules and hardware
cat /proc/meminfo
```

4. Monitor real-time system statistics
```
# Watch memory and CPU statistics (update every 2 seconds)
vmstat 2 3

# Monitor I/O statistics
iostat 2 3
```

## Part 3: User and Network Monitoring

1. Monitor user activity and system connections
```
# See who's logged in and what they're doing
who
w
last | head -10                  # Recent login history

# Check system boot time and current users
uptime
```

2. Monitor network connections and listening services
```
# Active network connections
ss -tuln                         # TCP/UDP listening ports
ss -tp                           # Active TCP connections with process info

# Network interface statistics
ip addr show
cat /proc/net/dev               # Network interface statistics
```

3. Examine system logs for issues
```
# Recent kernel messages
sudo dmesg | tail -20

# System journal entries (modern systemd systems)
sudo journalctl -n 20 --no-pager

# Check for authentication logs (Amazon Linux 2023)
sudo journalctl -u sshd -n 20 --no-pager
```

## Part 4: Advanced Process Control

1. Create a simple monitoring script
```
cat << 'EOF' > system_check.sh
#!/bin/bash
echo "=== System Status Report ==="
echo "Date: $(date)"
echo "Uptime: $(uptime -p)"
echo "Load Average: $(cut -d' ' -f1-3 /proc/loadavg)"
echo "Memory Used: $(free -h | awk 'NR==2{printf "%.1f%%", $3*100/$2}')"
echo "Disk Usage: $(df -h / | awk 'NR==2{print $5}')"
echo "Active Processes: $(ps aux | wc -l)"
EOF

chmod +x system_check.sh
./system_check.sh
```

## Cleanup
```
# Kill any remaining background processes
pkill -9 stress
cd ~
rm -rf ~/monitoring
```

## Conclusion

In this lab, you mastered essential system monitoring and process management skills critical for Linux system administration:

- **Process monitoring**: Using `top`, `htop`, `ps`, and process signals to track and control running programs
- **Resource monitoring**: Analyzing CPU, memory, disk, and network usage with tools like `free`, `df`, `vmstat`, and `iostat`
- **System information**: Gathering hardware and kernel details using `uname`, `lscpu`, and `/proc` filesystem data
- **User activity**: Monitoring login sessions and system access with `who`, `w`, and `last`
- **Network monitoring**: Checking active connections and listening services with `ss` and network statistics
- **Log analysis**: Examining system logs and kernel messages to identify potential issues

These monitoring skills enable you to maintain system health, diagnose performance problems, and respond quickly to issues in production environments. Regular monitoring helps prevent small problems from becoming major outages and ensures optimal system performance.

In the next lab, we'll explore job scheduling and automation to build upon these monitoring foundations.


